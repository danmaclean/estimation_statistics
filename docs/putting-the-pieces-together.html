<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 6 Putting the pieces together | Estimation Statistics</title>
  <meta name="description" content="Topic 6 Putting the pieces together | Estimation Statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 6 Putting the pieces together | Estimation Statistics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 6 Putting the pieces together | Estimation Statistics" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2021-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="confidence-intervals.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Estimation Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting up</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#knowledge-prerequisites"><i class="fa fa-check"></i><b>1.1.1</b> Knowledge prerequisites</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#software-prerequisites"><i class="fa fa-check"></i><b>1.1.2</b> Software prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio"><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#development-packages"><i class="fa fa-check"></i><b>1.4.2</b> Development packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a><ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#variability-in-measurements"><i class="fa fa-check"></i><b>2.1</b> Variability in measurements</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#summarising-your-data-can-lead-to-wrong-conclusions"><i class="fa fa-check"></i><b>2.2</b> Summarising your data can lead to wrong conclusions</a></li>
<li class="chapter" data-level="2.3" data-path="motivation.html"><a href="motivation.html#p---one-value-to-fool-them-all"><i class="fa fa-check"></i><b>2.3</b> <em>p</em> - one value to fool them all?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="motivation.html"><a href="motivation.html#ten-thousand-random-numbers"><i class="fa fa-check"></i><b>2.3.1</b> Ten Thousand Random Numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="motivation.html"><a href="motivation.html#estimation-statistics"><i class="fa fa-check"></i><b>2.4</b> Estimation Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>3</b> R Fundamentals</a><ul>
<li class="chapter" data-level="3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>3.1</b> About this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>3.2</b> Working with R</a></li>
<li class="chapter" data-level="3.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>3.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#dataframes"><i class="fa fa-check"></i><b>3.4</b> Dataframes</a></li>
<li class="chapter" data-level="3.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#packages"><i class="fa fa-check"></i><b>3.5</b> Packages</a></li>
<li class="chapter" data-level="3.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-r-help"><i class="fa fa-check"></i><b>3.6</b> Using R Help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="effect-size.html"><a href="effect-size.html"><i class="fa fa-check"></i><b>4</b> Effect Size</a><ul>
<li class="chapter" data-level="4.1" data-path="effect-size.html"><a href="effect-size.html#difference-in-sample-means"><i class="fa fa-check"></i><b>4.1</b> Difference in sample means</a><ul>
<li class="chapter" data-level="4.1.1" data-path="effect-size.html"><a href="effect-size.html#standardised-effect-sizes"><i class="fa fa-check"></i><b>4.1.1</b> Standardised Effect Sizes</a></li>
<li class="chapter" data-level="4.1.2" data-path="effect-size.html"><a href="effect-size.html#calculating-mean-difference-effect-sizes-in-practice"><i class="fa fa-check"></i><b>4.1.2</b> Calculating Mean Difference Effect Sizes in Practice</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="effect-size.html"><a href="effect-size.html#explained-variation"><i class="fa fa-check"></i><b>4.2</b> Explained variation</a><ul>
<li class="chapter" data-level="4.2.1" data-path="effect-size.html"><a href="effect-size.html#pearsons-r"><i class="fa fa-check"></i><b>4.2.1</b> Pearson’s <span class="math inline">\(r\)</span></a></li>
<li class="chapter" data-level="4.2.2" data-path="effect-size.html"><a href="effect-size.html#r2"><i class="fa fa-check"></i><b>4.2.2</b> <span class="math inline">\(r^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="effect-size.html"><a href="effect-size.html#using-the-effect-size"><i class="fa fa-check"></i><b>4.3</b> Using the effect size</a></li>
<li class="chapter" data-level="4.4" data-path="effect-size.html"><a href="effect-size.html#the-assumptions-of-effect-sizes"><i class="fa fa-check"></i><b>4.4</b> The assumptions of effect sizes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>5</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="5.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-1"><i class="fa fa-check"></i><b>5.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="5.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-on-normally-distributed-data"><i class="fa fa-check"></i><b>5.2</b> Confidence intervals on Normally distributed data</a></li>
<li class="chapter" data-level="5.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#using-a-ci"><i class="fa fa-check"></i><b>5.3</b> Using a CI</a><ul>
<li class="chapter" data-level="5.3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-in-practice"><i class="fa fa-check"></i><b>5.3.1</b> Confidence Intervals in practice</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-estimation-of-confidence-intervals"><i class="fa fa-check"></i><b>5.4</b> Bootstrap Estimation of Confidence Intervals</a></li>
<li class="chapter" data-level="5.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#plotting-the-bootstrap-distribution"><i class="fa fa-check"></i><b>5.5</b> Plotting the bootstrap distribution</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html"><i class="fa fa-check"></i><b>6</b> Putting the pieces together</a><ul>
<li class="chapter" data-level="6.1" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#incorporating-estimation-statistics-into-plots"><i class="fa fa-check"></i><b>6.1</b> Incorporating estimation statistics into plots</a><ul>
<li class="chapter" data-level="6.1.1" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#the-box-plot"><i class="fa fa-check"></i><b>6.1.1</b> The Box Plot</a></li>
<li class="chapter" data-level="6.1.2" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#adding-a-normal-ci-using-dplyr"><i class="fa fa-check"></i><b>6.1.2</b> Adding a Normal CI using dplyr</a></li>
<li class="chapter" data-level="6.1.3" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#non-normal-cis"><i class="fa fa-check"></i><b>6.1.3</b> Non Normal CIs</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#the-gardner-altman-plot"><i class="fa fa-check"></i><b>6.2</b> The Gardner-Altman Plot</a></li>
<li class="chapter" data-level="6.3" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#the-cumming-plot"><i class="fa fa-check"></i><b>6.3</b> The Cumming Plot</a></li>
<li class="chapter" data-level="6.4" data-path="putting-the-pieces-together.html"><a href="putting-the-pieces-together.html#the-derevnina-plot"><i class="fa fa-check"></i><b>6.4</b> The Derevnina Plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estimation Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="putting-the-pieces-together" class="section level1">
<h1><span class="header-section-number">Topic 6</span> Putting the pieces together</h1>
<p>Now that we’ve studied the two main estimation statistics principles - the effect size and the confidence interval, we should start to look at how to apply them in our work. In this chapter we will look at different plots and plot elements that use our computed estimation statistics clearly and informatively such that we can draw conclusions without hypothesis tests.</p>
<div id="incorporating-estimation-statistics-into-plots" class="section level2">
<h2><span class="header-section-number">6.1</span> Incorporating estimation statistics into plots</h2>
<p>You are likely familiar with this sort of plot, it is pretty much the most standard plot around, the bar chart with error bars. This one is of our <code>mouse_wt</code> data.</p>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>It is a very poor plot, for reasons we discussed in the preamble to this course and even in the literature, not least in this article by <span class="citation">Weissgerber (<a href="#ref-weissgerber2015" role="doc-biblioref">2015</a>)</span>. Another MAJOR thing about this plot is that it is only appropriate when the <span class="math inline">\(y\)</span>-axis data are continuous. When you have discrete or categorical data on the <span class="math inline">\(y\)</span>-axis, then this plot DOES NOT APPLY AT ALL. You can see a fuller discussion of why <a href="https://danmaclean.github.io/intro_to_stats/non-parametric-tests-and-linear-models.html#common-misrepresentations-of-discrete-data">here</a>.</p>
<p>Even though we do have continuous data in this example of mouse mass, the bars and error bars serve to hide the spread and patterns in the numbers, hiding the opportunity to understand what is going on in the data as clearly as possible, and if we apply tests blindly, they can lead us to false conclusions. The least we could do to avoid this would be to release the data! Recall how we can show each data point with a simple <code>ggplot</code> <code>geom_jitter()</code> call.</p>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>This is much clearer, we can see all the spread of and patterns in the data. This sort of dotted plot should always be a first step in plotting your data.</p>
<p>Let’s work towards look at adding a 95% percent CI of the mean on. First, an approach that <em>doesn’t</em> do this, but that you might be tempted to use as a shortcut.</p>
<div id="the-box-plot" class="section level3">
<h3><span class="header-section-number">6.1.1</span> The Box Plot</h3>
<p>A box plot (or more properly a box and whisker plot) is easy to add to a <code>ggplot</code>, and it is a great geom for showing features of the data like mean and spread, but it doesn’t do a 95% CI of the mean - not quite.</p>
<p>Here’s a general view of one, not our mouse data.</p>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>The thick horizontal central line shows the mean, which is useful. The edges of the box show the 25% to 75% IQR (interquartile range), a measure of the spread of the data in which the central 50% is covered by the box. The extent of the vertical lines (whiskers) show the IQR * 1.5 or the most extreme data point (whichever is smallest), the whisker is intended to show the data range. Any points that are beyond the range are drawn in individually and called <code>outliers</code> but they have no special statistical significance.</p>
<p>A further feature of the box plot, the notch, looks like this</p>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Those little wedges show the extent of <code>1.58 * IQR / sqrt(n)</code> which is roughly a 95% CI of the mean in normally distributed data, so it can be useful if you have normally distributed data. In this case (and only in this case) if the notches don’t overlap between groups you have a visual clue that there are differences between the groups.</p>
<p>The box plot shouldn’t be used on its own though. Here is one with our mouse data, including a notch.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="putting-the-pieces-together.html#cb55-1"></a>base_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## notch went outside hinges. Try setting notch=FALSE.
## notch went outside hinges. Try setting notch=FALSE.</code></pre>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>The notch has gone wild in this one! This is because the sample size is so small (10 data points), the range of the notch goes out of the range of the box and the drawing of the lines in the box goes crazy. The box plot is here harder to interpret.</p>
</div>
<div id="adding-a-normal-ci-using-dplyr" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Adding a Normal CI using dplyr</h3>
<p>To add a CI we can use the <code>dplyr</code> package to calculate the CI limits then add it to a plot. You will recall that it goes like this</p>
<ol style="list-style-type: decimal">
<li>Use the <code>group_by</code> function to group the data into respective groups to work on them one-by-one</li>
<li>Use the <code>summarize</code> function to get the summary data we need for each group. We’ll need the mean mass, SD of mass and number of rows (<code>n()</code>).</li>
<li>Use the <code>summarize</code> function to apply the formula we used for the Normal 95% CI</li>
<li>Use the <code>summarise</code> function to add the CI upper and lower limits to the mean.</li>
</ol>
<p>Note that steps 2 to 4 can be done in one pass. The code looks like this</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="putting-the-pieces-together.html#cb57-1"></a>ci_df &lt;-<span class="st"> </span>mouse_wts <span class="op">%&gt;%</span></span>
<span id="cb57-2"><a href="putting-the-pieces-together.html#cb57-2"></a><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-3"><a href="putting-the-pieces-together.html#cb57-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(mass),</span>
<span id="cb57-4"><a href="putting-the-pieces-together.html#cb57-4"></a>            <span class="dt">n =</span> <span class="kw">n</span>(),</span>
<span id="cb57-5"><a href="putting-the-pieces-together.html#cb57-5"></a>            <span class="dt">s =</span> <span class="kw">sd</span>(mass),</span>
<span id="cb57-6"><a href="putting-the-pieces-together.html#cb57-6"></a>            <span class="dt">half_width =</span> <span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>s <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n),</span>
<span id="cb57-7"><a href="putting-the-pieces-together.html#cb57-7"></a>            <span class="dt">upper =</span> mean <span class="op">+</span><span class="st"> </span>half_width,</span>
<span id="cb57-8"><a href="putting-the-pieces-together.html#cb57-8"></a>            <span class="dt">lower =</span> mean <span class="op">-</span><span class="st"> </span>half_width</span>
<span id="cb57-9"><a href="putting-the-pieces-together.html#cb57-9"></a>  )</span>
<span id="cb57-10"><a href="putting-the-pieces-together.html#cb57-10"></a>ci_df</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   group   mean     n     s half_width upper lower
## * &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 group1  22.7    10  8.16       5.06  27.7 17.6 
## 2 group2  11.1    10  2.82       1.75  12.8  9.32</code></pre>
<p>And the resulting <code>ci_df</code> contains the calculated values including the upper and lower values of the CI.</p>
<p>We can apply the summaries to our existing plot using <code>geom_errorbar()</code> and the <code>data</code> argument, which will use our new data frame as the data source exclusively for this geom.</p>
<p>Because our new data frame doesn’t have the original data in it, we have to turn off the original data mapping <code>aes()</code> with the <code>inherit.aes</code> argument and rename the <span class="math inline">\(x\)</span> axis and colour in a new <code>aes()</code>. We should also set the width of the cross lines at the limits of the error bars as they come out comically wide by default.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="putting-the-pieces-together.html#cb59-1"></a>base_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> ci_df, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">ymax=</span>upper, <span class="dt">ymin=</span>lower, <span class="dt">colour=</span>group), <span class="dt">width=</span><span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>And there we have a clear view of the 95% CI of the means in our groups.</p>
</div>
<div id="non-normal-cis" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Non Normal CIs</h3>
<p>To add a non-normal CI we need to first calculate the CI using bootstrap resampling. This is a semi-involved process, the <code>dabestR</code> package makes it easy, so we’ll look at using that. We will use it to make two specific types of plot, the Gardner-Altman <span class="citation">(Gardner and Altman <a href="#ref-gardner1986" role="doc-biblioref">1986</a>)</span> plot and the Cumming plot <span class="citation">(Cumming <a href="#ref-cumming2012" role="doc-biblioref">2012</a>)</span>. So far we’ve concentrated only on continuous <span class="math inline">\(y\)</span> data, so we will also look at making a Derevnina plot <span class="citation">(Derevnina et al. <a href="#ref-derevnina2021" role="doc-biblioref">2021</a>)</span>, a variant for categoric data, with the <code>besthr</code> package.</p>
</div>
</div>
<div id="the-gardner-altman-plot" class="section level2">
<h2><span class="header-section-number">6.2</span> The Gardner-Altman Plot</h2>
<p>Invented in 1986 by Gardner and Altman, this is a plot for two group continuous data that can show a choice of effect size and the 95% bootstrap CI and distribution in a single panel.</p>
<p>Let’s make one with <code>dabestr</code></p>
<p>The first step is to load our <code>mouse_wts</code> data into a <code>dabest</code> object. We must specify the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variable names and using the <code>idx</code> argument, the two groups to be compared. The first group will be considered the base for comparison group. We must also tell the function whether these data are paired or not.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="putting-the-pieces-together.html#cb60-1"></a><span class="kw">library</span>(dabestr)</span>
<span id="cb60-2"><a href="putting-the-pieces-together.html#cb60-2"></a></span>
<span id="cb60-3"><a href="putting-the-pieces-together.html#cb60-3"></a>dbest_data &lt;-<span class="st"> </span><span class="kw">dabest</span>(mouse_wts, group, mass,  <span class="dt">idx =</span> <span class="kw">c</span>(<span class="st">&quot;group1&quot;</span>, <span class="st">&quot;group2&quot;</span>), <span class="dt">paired =</span> <span class="ot">FALSE</span>)</span>
<span id="cb60-4"><a href="putting-the-pieces-together.html#cb60-4"></a></span>
<span id="cb60-5"><a href="putting-the-pieces-together.html#cb60-5"></a>dbest_data</span></code></pre></div>
<pre><code>## dabestr (Data Analysis with Bootstrap Estimation in R) v0.3.0
## =============================================================
## 
## Good afternoon!
## The current time is 13:23 pm on Tuesday February 09, 2021.
## 
## Dataset    :  mouse_wts
## The first five rows are:
##    group     mass
## 1 group1 19.57635
## 2 group1 29.59349
## 3 group1 23.89572
## 4 group1 17.75500
## 5 group1 11.47902
## 
## X Variable :  group
## Y Variable :  mass
## 
## Effect sizes(s) will be computed for:
##   1. group2 minus group1</code></pre>
<p>We get a summary that is very friendly and let’s us verify whether we entered the data properly.</p>
<p>We can now do an effect size calculation to add to the data object. Here we’ll use the mean sample difference, but there are other options, including a <code>cohens_d()</code> function.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="putting-the-pieces-together.html#cb62-1"></a>dbest_with_mean_diff &lt;-<span class="st"> </span><span class="kw">mean_diff</span>(dbest_data)</span></code></pre></div>
<p>We can now draw the plot with the generic <code>plot()</code> function.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="putting-the-pieces-together.html#cb63-1"></a><span class="kw">plot</span>(dbest_with_mean_diff)</span></code></pre></div>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>This plot is extrememly informative and gives us a super clear indication of our data, the points are shown, the sample size is quoted, the effect size is plotted and the bootstrap CI and distribution are plotted. This is everything we need from a plot and statistical procedure. Importantly, we can conclude that these two samples are not likely to be the same without relying on opaque statistical tests. The plot and the generated numbers also make any argument that the observed differences are significant clearly convincing.</p>
</div>
<div id="the-cumming-plot" class="section level2">
<h2><span class="header-section-number">6.3</span> The Cumming Plot</h2>
<p>The Cumming plot extends the ideas of the Gardner-Altman plot into more groups and comparisons, named after Cumming who suggested designs like this in his paper <span class="citation">(Cumming <a href="#ref-cumming2012" role="doc-biblioref">2012</a>)</span>.</p>
<p>The setup is similar, we will need some data with more groups in it, <code>mouse_wt_4g</code>. The othe major difference is that the comparison specification is wrapped in a list of comparisons.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="putting-the-pieces-together.html#cb64-1"></a><span class="kw">library</span>(dabestr)</span>
<span id="cb64-2"><a href="putting-the-pieces-together.html#cb64-2"></a>mouse_wt_4g <span class="op">%&gt;%</span></span>
<span id="cb64-3"><a href="putting-the-pieces-together.html#cb64-3"></a><span class="st">  </span><span class="kw">dabest</span>(group, mass, </span>
<span id="cb64-4"><a href="putting-the-pieces-together.html#cb64-4"></a>         <span class="dt">idx =</span> <span class="kw">list</span>(</span>
<span id="cb64-5"><a href="putting-the-pieces-together.html#cb64-5"></a>                <span class="kw">c</span>(<span class="st">&#39;group1&#39;</span>, <span class="st">&#39;group2&#39;</span>,<span class="st">&#39;group3&#39;</span>,<span class="st">&#39;group4&#39;</span>)</span>
<span id="cb64-6"><a href="putting-the-pieces-together.html#cb64-6"></a>                ),</span>
<span id="cb64-7"><a href="putting-the-pieces-together.html#cb64-7"></a>         <span class="dt">paired=</span><span class="ot">FALSE</span></span>
<span id="cb64-8"><a href="putting-the-pieces-together.html#cb64-8"></a>   ) <span class="op">%&gt;%</span></span>
<span id="cb64-9"><a href="putting-the-pieces-together.html#cb64-9"></a><span class="st">  </span><span class="kw">mean_diff</span>() <span class="op">%&gt;%</span></span>
<span id="cb64-10"><a href="putting-the-pieces-together.html#cb64-10"></a><span class="st">  </span><span class="kw">plot</span>()</span></code></pre></div>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>The plot shows something similar to the Gardner-Altman in a two-panel layout to allow the bootstrap profiles space. Also the black lines show the extent of the standard deviation, with the mean represented by the gap.</p>
<p>As with the previous plot, this is easy to interpret, rich and informative and convincing. It is clear to see in this plot that the masses of <code>group1</code> are substantially and significantly higher than the other groups. We see also that <code>group2</code> is not different to <code>group3</code> or <code>group4</code>, but <code>group3</code> and <code>group4</code> are different from each other.</p>
</div>
<div id="the-derevnina-plot" class="section level2">
<h2><span class="header-section-number">6.4</span> The Derevnina Plot</h2>
<p>The Gardner-Altman and Cumming plots work really well on continuous <span class="math inline">\(y\)</span> data. As we have discussed before <a href="https://danmaclean.github.io/intro_to_stats/non-parametric-tests-and-linear-models.html#common-misrepresentations-of-discrete-data">here</a>, categorical or discrete data need a different representation. An extension of the ideas here for categoric data in general is the Derevnina plot, which was applied specifically to HR experiment score data in her paper <span class="citation">(Derevnina et al. <a href="#ref-derevnina2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>The basic idea is the same, we have HR score data with e.g strain, replicate and score.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="putting-the-pieces-together.html#cb65-1"></a>hr_scores</span></code></pre></div>
<pre><code>##     strain replicate score
## 1  control         1     1
## 2  control         2     2
## 3  control         3     1
## 4  control         4     1
## 5  control         5     1
## 6  control         6     2
## 7     mild         1     3
## 8     mild         2     4
## 9     mild         3     4
## 10    mild         4     4
## 11    mild         5     5
## 12    mild         6     4
## 13  deadly         1     5
## 14  deadly         2     4
## 15  deadly         3     6
## 16  deadly         4     5
## 17  deadly         5     4
## 18  deadly         6     5</code></pre>
<p>We can use the <code>besthr</code> package to create analgous plots for this categoric data. The <code>estimate()</code> function requires the data, the <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> variable names and the name of the control in <span class="math inline">\(x\)</span>. It will return an estimation object, which we can plot.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="putting-the-pieces-together.html#cb67-1"></a><span class="kw">library</span>(besthr)</span>
<span id="cb67-2"><a href="putting-the-pieces-together.html#cb67-2"></a></span>
<span id="cb67-3"><a href="putting-the-pieces-together.html#cb67-3"></a>est_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">estimate</span>(hr_scores, score, strain, <span class="dt">control=</span><span class="st">&quot;control&quot;</span>)</span>
<span id="cb67-4"><a href="putting-the-pieces-together.html#cb67-4"></a><span class="kw">plot</span>(est_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Picking joint bandwidth of 0.413</code></pre>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>The resulting bootstrap estimations are performed on ranked data, the ranks are computed automatically for us and the resulting rank mean difference shown as dotted lines. The blue areas of the bootstrap distribution show the 95% CI for the mean rank. The plot is again very clear that the <code>control</code> has lower mean rank than each of the other two <code>strain</code>s but the <code>mild</code> and <code>deadly</code> strains are not much different from each other.</p>
<p>We can see technical replicates if we have used them by extending the call to estimate to include these explictly and we can plot them by setting the <code>which</code> argument to <code>just_data</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="putting-the-pieces-together.html#cb69-1"></a>est_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">estimate</span>(hr_scores, score, strain, replicate, <span class="dt">control=</span><span class="st">&quot;control&quot;</span>)</span>
<span id="cb69-2"><a href="putting-the-pieces-together.html#cb69-2"></a><span class="kw">plot</span>(est_<span class="dv">2</span>, <span class="dt">which=</span><span class="st">&quot;just_data&quot;</span>)</span></code></pre></div>
<pre><code>## Picking joint bandwidth of 0.403</code></pre>
<p><img src="estimation-stats_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>The plot is clearer now about the spread of scores in different replicates.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-cumming2012">
<p>Cumming, Geoff. 2012. <em>Understanding the New Statistics: Effect Sizes, Confidence Intervals, and Meta-Analysis.</em> New York: Routledge.</p>
</div>
<div id="ref-derevnina2021">
<p>Derevnina, Lida, Mauricio P. Contreras, Hiroaki Adachi, Jessica Upson, Angel Vergara Cruces, Rongrong Xie, Jan Sklenar, et al. 2021. “Plant Pathogens Convergently Evolved to Counteract Redundant Nodes of an Nlr Immune Receptor Network.” <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2021.02.03.429184">https://doi.org/10.1101/2021.02.03.429184</a>.</p>
</div>
<div id="ref-gardner1986">
<p>Gardner, M J, and D G Altman. 1986. “Confidence Intervals Rather Than P Values: Estimation Rather Than Hypothesis Testing.” <em>BMJ</em> 292 (6522): 746–50. <a href="https://doi.org/10.1136/bmj.292.6522.746">https://doi.org/10.1136/bmj.292.6522.746</a>.</p>
</div>
<div id="ref-weissgerber2015">
<p>Weissgerber, Natasa M. AND Winham, Tracey L. AND Milic. 2015. “Beyond Bar and Line Graphs: Time for a New Data Presentation Paradigm.” <em>PLOS Biology</em> 13 (4): 1–10. <a href="https://doi.org/10.1371/journal.pbio.1002128">https://doi.org/10.1371/journal.pbio.1002128</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="confidence-intervals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
